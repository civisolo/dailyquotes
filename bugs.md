# 已知BUG与修复记录（bugs.md）

## 已修复
- [x] 白噪音上传路径不统一，已全部保存到backend/audio
- [x] 金句分页接口未随机，已改为随机返回
- [x] 首页金句批量加载后UI展示异常，已恢复为单条滑动卡片
- [x] TTS播放完毕后按钮未自动还原，已修复
- [x] .gitignore未忽略audio/uploads目录，已修复
- [x] 白噪音循环播放功能
- [x] 修复底部TabBar溢出导致的UI报错
- [x] 语言包丢失导致无法加载（已修复）
- [x] pubspec.yaml 字体声明错误（已修复）
- [x] 设置页"跟随系统"切换报错（已修复）
- [x] 提醒时间格式化占位符未替换（已修复）
- [x] home_page.dart 未国际化（已修复）
- [x] 日语翻译过长（已优化）
- [x] 历史页面时间显示未国际化（已修复）
- [x] 音量调节滑块无效（已修复，现已实时生效）
- [x] 点击通知进入应用后，badge 计数不会消失
  - 修复方案：在 NotificationService 中添加 clearBadge 方法，并在应用启动和通知点击时调用
  - 修复时间：2024-03-21
- [x] 已移除 SharedPreferences 相关代码，当前无相关遗留问题。

## 未修复
- [ ] API无鉴权，存在安全隐患
- [ ] 白噪音/金句大文件上传无进度提示
- [ ] 部分异常未做用户友好提示
- [ ] 云端收藏/历史未实现
- [ ] 白噪音播放偶发 dispose 报错（需进一步排查）
- [ ] 部分页面极端情况下 UI 未适配（待优化）
- [ ] 其它 bug 持续跟踪中

## 说明
- 每次发现新bug请先记录，修复后打勾
- 重大bug请及时同步到todos.md

# Bug记录

## 当前优先修复的Bug
1. Hive适配器问题
   - [x] 需要重新生成适配器
   - [x] 验证适配器功能
   - [x] 测试本地存储

2. 音频播放问题
   - [ ] 优化播放状态管理
   - [ ] 修复播放切换问题
   - [ ] 添加错误处理

3. UI响应问题
   - [ ] 优化页面切换动画
   - [ ] 改善滑动性能
   - [ ] 优化加载状态显示

## 已知Bug列表

### 前端
- [x] Hive适配器生成问题
- [ ] 音频播放器状态管理不完善
- [ ] 网络请求错误处理不完善
- [ ] UI响应性需要优化
- [ ] 移动端适配问题
- [ ] 深色模式切换闪烁问题
- [ ] 音量调节不够平滑
- [ ] 收藏按钮状态同步延迟

### 后端
- [ ] 文件上传大小限制未设置
- [ ] 错误处理机制不完善
- [ ] 日志记录不完整
- [ ] 数据库连接池未配置
- [ ] 缓存机制未实现
- [ ] API响应时间过长
- [ ] 并发请求处理不完善

### Admin
- [ ] 文件上传进度未显示
- [ ] 错误提示不友好
- [ ] 数据统计功能未实现
- [ ] 用户管理功能未实现
- [ ] UI响应性需要优化

## 已修复的Bug
- [x] 主题切换功能异常
- [x] 收藏功能无法使用
- [x] 白噪音播放失败
- [x] TTS播放卡顿
- [x] 页面切换动画丢失
- [x] 设置页面样式错误
- [x] Hive适配器问题
- [x] 肯定语音播放完成后，播放按钮状态没有正确更新为播放图标
- [x] 白噪音播放按钮状态显示不正确

## 待修复
- [ ] 音频播放器状态管理不完善
- [ ] 网络请求错误处理不完善
- [ ] 移动端适配问题
- [ ] 深色模式切换闪烁问题
- [ ] 音量调节不够平滑
- [ ] 收藏按钮状态同步延迟
- [ ] 文件上传大小限制未设置
- [ ] 错误处理机制不完善
- [ ] 日志记录不完整
- [ ] 数据库连接池未配置
- [ ] 缓存机制未实现
- [ ] API响应时间过长
- [ ] 并发请求处理不完善
- [ ] 文件上传进度未显示
- [ ] 错误提示不友好
- [ ] 数据统计功能未实现
- [ ] 用户管理功能未实现
- [ ] UI响应性需要优化

# DailyMind 已知问题

## 音频播放相关
- [ ] 音频播放状态同步问题
  - 描述：金句播放按钮状态更新不正确，白噪音按钮状态不反映暂停状态
  - 影响：用户体验不佳
  - 解决方案：优化状态管理，确保UI状态与播放状态同步

- [ ] 音频加载性能问题
  - 描述：音频加载较慢，影响用户体验
  - 影响：首次播放延迟
  - 解决方案：实现音频预加载和缓存机制

## 系统稳定性
- [ ] 代理配置问题
  - 描述：在某些环境下代理配置可能导致连接问题
  - 影响：API调用失败
  - 解决方案：优化代理配置，添加自动重试机制

- [ ] 错误处理不完善
  - 描述：部分错误未得到适当处理
  - 影响：用户体验不佳
  - 解决方案：完善错误处理机制，添加用户友好的错误提示

## 已修复
- [x] 金句生成超时问题
  - 描述：生成金句时出现超时错误
  - 解决方案：添加代理配置，优化生成逻辑

- [x] 白噪音文件上传问题
  - 描述：上传大文件时出现错误
  - 解决方案：优化文件上传逻辑，添加文件大小限制

## 优先级
1. 音频播放状态同步问题
2. 音频加载性能问题
3. 代理配置问题
4. 错误处理完善

## 注意事项
- 所有新发现的bug都应该记录在此文档中
- 修复bug后，将对应的条目标记为已完成
- 定期检查和更新bug列表
- 优先处理影响用户体验的关键问题

# DailyMind Bugs 记录

## 已知问题

### 1. 音频播放相关
- [ ] 音频播放状态同步问题
  - 现象：前端音频播放按钮状态与实际播放不同步
  - 影响：用户体验不佳
  - 解决方案：优化状态管理与回调
- [ ] 音频加载性能问题
  - 现象：首次播放音频加载慢
  - 影响：等待时间长
  - 解决方案：预加载与缓存

### 2. 系统稳定性
- [ ] 代理配置问题
  - 现象：部分API请求超时或失败
  - 解决方案：完善代理配置与错误处理
- [ ] 错误处理不完善
  - 现象：部分异常未被捕获，日志不全
  - 解决方案：补充try/except与日志

### 3. 警告与兼容性
- [ ] DeprecationWarning: datetime.datetime.utcnow() is deprecated
  - 现象：后端/管理后台出现弃用警告
  - 影响：未来Python版本可能不兼容
  - 解决方案：改用 datetime.now(datetime.UTC)
- [ ] 静态文件夹警告
  - 现象：管理后台启动时提示 static 文件夹不存在
  - 影响：无实际功能影响，但有警告
  - 解决方案：创建空 static 文件夹或关闭静态服务
- [ ] Flutter插件编译警告
  - 现象：webview_flutter_wkwebview和flutter_local_notifications插件编译时出现警告
  - 影响：不影响功能，但影响编译体验
  - 解决方案：等待插件更新或提交PR修复

## 已修复问题
- [x] Affirmation生成超时问题
- [x] 文件上传失败问题
- [x] 代理参数配置错误

## 记录与管理
- 新增bug请补充本文件，修复后请打勾并注明方案
- 定期review和清理历史问题

- [ ] 暂无新bug。金句卡片字体大小自定义功能已联动并测试。 